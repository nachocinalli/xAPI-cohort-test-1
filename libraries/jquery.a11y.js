!function(e,t){var a=/iPad|iPhone|iPod/.test(navigator.platform),n={globalTabIndexElementFilter:":not(.a11y-ignore)",focusableElementsFilter:":visible:not(.disabled):not([tabindex='-1']):not(:disabled):not(.a11y-ignore-focus)",ariaLabelElementsFilter:":not( .a11y-ignore-aria [aria-label] )",ariaHiddenParentsFilter:":not(#wrapper):not(body)"},l={focuser:"#a11y-focuser",focusguard:".a11y-focusguard",selected:"#a11y-selected",ignoreFocusElements:".a11y-ignore-focus",nativeSpaceElements:"textarea, input[type='text'], div[contenteditable=true]",nativeEnterElements:"textarea, a, button, input[type='checkbox'], input[type='radio']",nativeTabElements:"textarea, input, select",wrapIgnoreElements:"a,button,input,select,textarea,br",wrapStyleElements:"b,i,abbr,strong,em,small,sub,sup,ins,del,mark",globalTabIndexElements:"a,button,input,select,textarea,[tabindex]",focusableElements:"a,button,input,select,textarea,[tabindex],label",focusableElementsAccessible:":not(a,button,input,select,textarea)[tabindex]",hideableElements:".a11y-hideable",ariaLabelElements:"div[aria-label], span[aria-label]"},i={focuser:'<a id="a11y-focuser" href="#" class="prevent-default a11y-ignore" tabindex="-1" role="presentation" aria-label=".">&nbsp;</a>',focusguard:'<a class="a11y-focusguard a11y-ignore a11y-ignore-focus" tabindex="0" role="button">&nbsp;</a>',selected:'<a id="a11y-selected" href="#" class="prevent-default a11y-ignore" tabindex="-1">&nbsp;</a>',arialabel:"<span class='aria-label prevent-default' tabindex='0' role='region'></span>"};function s(e){return e.replace(s.regex,"")}function r(e,t,a){var n=t||this,l=arguments;return setTimeout(function(){e.apply(n,l)},a||0)}function o(e){e.preventDefault(),e.stopPropagation()}function d(a){var n=e.a11y.state,l=e.a11y.options;if((l.isDebug&&console.log("preventScroll1"),n.scrollDisabledElements&&n.scrollDisabledElements.length>0)&&0===f(a).filter(n.scrollDisabledElements).length)return void e(t).scroll();return l.isDebug&&console.log("preventScroll2"),a.preventDefault(),!1}s.regex=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;var c={37:1,38:1,39:1,40:1};function u(t){var a=e.a11y.state,n=e.a11y.options;if(!e(t.target).is(l.nativeTabElements)){if(n.isDebug&&console.log("preventScroll1"),a.scrollDisabledElements&&a.scrollDisabledElements.length>0)if(0===f(t).filter(a.scrollDisabledElements).length)return;return n.isDebug&&console.log("preventScroll2"),c[t.keyCode]?(d(t),!1):void 0}}function f(t){var a,n,l=e(t.target);if("touchmove"==t.type){var i=e.a11y.state;if(!i.scrollStartEvent||!i.scrollStartEvent.originalEvent)return l;var s=t.originalEvent.pageY,r=i.scrollStartEvent.originalEvent.pageY;if(0!==s&&s!=r||(s=t.originalEvent.touches[0].pageY,r=i.scrollStartEvent.originalEvent.touches[0].pageY),0===(a=s-r))return e("body");n=a>0?"up":"down"}else{if(0===(a=t.originalEvent.wheelDeltaY||t.originalEvent.deltaY!==undefined?-t.originalEvent.deltaY:t.originalEvent.wheelDelta||undefined))return e("body");n=a>0?"up":"down"}for(var o=l.parents(),d=0,c=o.length;d<c;d++){var u=e(o[d]);if(u.is("body"))return u;switch(u.css("overflow-y")){case"auto":case"scroll":var f=Math.ceil(u.scrollTop()),b=u.outerHeight(),h=u[0].scrollHeight;switch(n){case"down":if(f+b<h)return u;break;case"up":if(f>0)return u}u}}return e("body")}function b(t){return function(e){for(var t="",a=0;a<e[0].children.length;a++)t+=e[0].children[a].outerHTML;return t}(function a(t){var n=t.children();if(0===n.length){var i=t.text();return""===s(i)?t:(g(t),t.append(m(e("<span>"+i+"</span>"))),t)}var r=0;for(var o=0;o<n.length;o++)e(n[o]).is(l.wrapStyleElements)&&r++;if(r===n.length)return e("<span>").append(m(t));var d=[];var c=!1;for(var u=0;u<t[0].childNodes.length;u++){var f=t[0].childNodes[u],b=e(f.outerHTML)[0];switch(f.nodeType){case 3:d.push(m(e("<span>"+f.textContent+"</span>"))),c=!0;break;case 1:var h=e(b);if(h.is(l.wrapStyleElements)&&!c||h.is(l.wrapIgnoreElements))d.push(h);else{var p=h.children();if(0===p.length){var i=h.text();""!==s(i)&&m(h)}else a(h);d.push(h)}}}g(t);t.append(d);return t;function g(e){for(var t=e[0].childNodes.length,a=t-1;a>-1;a--)e[0].childNodes[a].remove?e[0].childNodes[a].remove():e[0].removeChild?e[0].removeChild(e[0].childNodes[a]):e[0].childNodes[a].removeNode&&e[0].childNodes[a].removeNode(!0);return e}function m(e){return e.attr({role:"region",tabindex:0}).addClass("prevent-default"),e}}(function(t){var a;try{a=e("<div>"+t+"</div>")}catch(n){throw n}return a}(t)))}function h(t){var a=e.a11y.options,n=e(t.target);switch(t.which){case 32:if(n.is(l.nativeSpaceElements))return;o(t),a.isDebug&&console.log("a11y: space keyup > click"),n.trigger("click");break;case 27:a.isDebug&&console.log("a11y: escape keyup > focus on first element"),e.a11y_focus()}}function p(t){var a=e.a11y.options,n=e(t.target);switch(t.which){case 32:if(n.is(l.nativeSpaceElements))return;o(t),a.isDebug&&console.log("a11y: space keydown > blocked default");break;case 13:if(n.is(l.nativeEnterElements))return;o(t),a.isDebug&&console.log("a11y: enter keydown > click"),n.trigger("click")}}function g(t){var a=e.a11y.options,n=e.a11y.state,i=e(t.target);if(!i.is(l.globalTabIndexElements)){var s=i.parents(),r=s.filter(l.globalTabIndexElements);if(0===r.length){var o=s.filter("[for]");if(0===o.length)i=i.focusOrNext(!0);else{var d=e("#"+o.attr("for"));i=d.is(l.globalTabIndexElements)?d:i.focusOrNext(!0)}}else i=e(r[0])}n.$activeElement=i,a.isDebug&&console.log("focusCapture",i[0])}function m(t){var a=e.a11y.options,n=e.a11y.state,i=e(t.target);if(i.is(l.globalTabIndexElements)){!function(t){var a;if(t.attr("aria-labelledby")){var n=e("#"+t.attr("aria-labelledby"));a=n.attr("aria-label")||n.text()}else a=t.attr("aria-label")||t.text();e(document).trigger("reading",s(a))}(i),a.isDebug&&console.log("focus",i[0]),n.$activeElement=e(t.currentTarget),n.$activeElement.is(l.nativeTabElements)&&(e.a11y.userInteracted=!0);a=e.a11y.options;i.limitedScrollTo()}}function y(t){return e.a11y.state.scrollStartEvent=t,!0}function v(t){return e.a11y.state.scrollStartEvent=null,!0}function E(){var t=e.a11y.state.floorStack[e.a11y.state.floorStack.length-1];1==e.a11y.state.floorStack.length?0===t.find(l.focusguard).length&&e(i.focusguard).appendTo(t).attr("tabindex",0):0===t.find(l.focusguard).length&&(console.warn("DEPRECATED (a11y_reattachFocusGuard) - Use the Handlebars helper a11y_wrap_focus after the last tabbable element in the popup"),e(i.focusguard).appendTo(t).attr("tabindex",0))}function x(){var t,a;e.a11y.state.isIOSFixesApplied||(e.a11y.state.isIOSFixesApplied=!0,t=!1,a=e.a11y.options,e("body").on("click","*",function(n){if(!t){g(n);var i=e.a11y.state.$activeElement;i.is(l.globalTabIndexElements)&&(a.isDebug&&console.log("a11y_iosFalseClickFix",i[0]),t=!0,r(function(){i.focus(),t=!1},500))}}))}e.fn.scrollDisable=function(){if(0===this.length)return this;var a,n=e.a11y.options,l=e.a11y.state;return n.isScrollDisableEnabled?(l.scrollDisabledElements?l.scrollDisabledElements=l.scrollDisabledElements.add(this):l.scrollDisabledElements=e(this),l.scrollDisabledElements.length>0&&(a="wheel mousewheel",e(t).on(a,d),e(document).on(a,d),e(t).on("touchstart",y),e(t).on("touchmove",d),e(t).on("touchend",v),e(document).on("keydown",u)),this):this},e.fn.scrollEnable=function(){if(0===this.length)return this;var a,n=e.a11y.options,l=e.a11y.state;if(!n.isScrollDisableEnabled)return this;l.scrollDisabledElements&&(l.scrollDisabledElements=l.scrollDisabledElements.not(this),0===l.scrollDisabledElements.length&&(a="wheel mousewheel",e(t).off(a,d),e(document).off(a,d),e(t).off("touchstart",y),e(t).off("touchmove",d),e(t).off("touchend",v),e(document).off("keydown",u)))},e.fn.isFixedPostion=function(){if(0===this.length)return!1;var t=e(this[0]);if(!t)return!1;if("fixed"==t.css("position"))return!0;if(t.is(".fixed"))return!0;for(var a=t.parents(),n=0,l=a.length;n<l;n++){if("fixed"==e(a[n]).css("position"))return!0;if(e(a[n]).is(".fixed"))return!0}return!1},e.fn.limitedScrollTo=function(){var n=e.a11y.options;if(!n.isFocusLimited)return this;if(0===this.length)return this;var l=e(this[0]);if(l.isFixedPostion())return this;var i=(n=n||{}).focusOffsetTop||0,s=n.focusOffsetTop||0,o=l.offset().top,d=e(t).scrollTop()+i,c=e(t).innerHeight()-s-i,u=o-i-c/2;if(u<0&&(u=0),o<d||o>d+c)return l.is("select, input[type='text'], textarea")&&a?r(function(){n.isDebug&&console.log("limitedScrollTo select fix",this.scrollToPosition),e.scrollTo(this.scrollToPosition,{duration:0})},{scrollToPosition:u},1e3):(n.isDebug&&console.log("limitedScrollTo",u),r(function(){e.scrollTo(this.scrollToPosition,{duration:0})},{scrollToPosition:u})),this;l.is("select, input[type='text'], textarea")&&a&&r(function(){n.isDebug&&console.log("limitedScrollTo select fix",this.scrollToPosition),e.scrollTo(this.scrollToPosition,{duration:0})},{scrollToPosition:u},1e3)},e.fn.focusNoScroll=function(){return 0===this.length?this:(r(function(){e.a11y.options.isDebug&&console.log("focusNoScroll",this[0]);var a=e(t).scrollTop();try{this[0].focus()}catch(n){}t.scrollTo(null,a)},this),this)},e.fn.focusOrNext=function(t){if(0===this.length)return this;var a=e(this[0]),i=a.is(l.focuser)||a.is(l.focusguard)||a.is(l.selected),s=a.is(l.focusableElements)&&a.is(n.focusableElementsFilter);if(!i&&!s){var r=a.nextAll(l.focusableElements),o=r.filter(n.focusableElementsFilter);if(0===r.length||0===o.length){var d=a.parents().nextAll().find(l.focusableElements).filter(n.focusableElementsFilter);a=0===d.length?e(l.focuser):e(d[0])}else a=e(o[0])}var c=e.a11y.options;return c.isDebug&&console.log("focusOrNext",a[0]),!0!==t&&("mac"!=c.OS&&e(l.focuser).focusNoScroll(),a.focusNoScroll()),a},e.a11y=function(t,a){return e.a11y.options.isDebug&&console.log("$.a11y called",t,a),this},e.a11y.options={focusOffsetTop:0,focusOffsetBottom:0,animateDuration:250,OS:"",isTouchDevice:!1,isTabbableTextEnabled:!1,isUserInputControlEnabled:!0,isFocusControlEnabled:!0,isFocusLimited:!1,isRemoveNotAccessiblesEnabled:!0,isAriaLabelFixEnabled:!0,isFocusWrapEnabled:!0,isScrollDisableEnabled:!0,isScrollDisabledOnPopupEnabled:!1,isSelectedAlertsEnabled:!1,isAlertsEnabled:!1,isIOSFixesEnabled:!0,isDebug:!1},e.a11y.state={$activeElement:null,floorStack:[e("body")],focusStack:[],tabIndexes:{},elementUIDIndex:0,scrollDisabledElements:null,scrollStartEvent:null},e.a11y.ready=function(){var t,n=e.a11y.options;a&&(n.OS="mac"),0===e(l.selected).length&&e("body").append(e(i.selected)),0===e(l.focuser).length&&e("body").append(e(i.focuser)),t=e.a11y.options,e.a11y.state.isFocusGuardSetup||(e.a11y.state.isFocusGuardSetup=!0,e("body").on("click focus",l.focusguard,function(a){return t.isDebug&&console.log("focusguard"),o(a),e.a11y_focus(!0),!1})),n.isUserInputControlEnabled&&(e("body").off("click",".prevent-default",o).off("keyup",h).off("keydown",p),e("body").on("click",".prevent-default",o).on("keyup",h).on("keydown",p)),n.isFocusControlEnabled&&(e.a11y.options,e("body").off("mousedown touchstart",l.focusableElements,g).off("focus",l.globalTabIndexElements,m),e("body").on("mousedown touchstart",l.focusableElements,g).on("focus",l.globalTabIndexElements,m)),n.isFocusWrapEnabled&&E(),a&&n.isIOSFixesEnabled&&x(),n.isDebug&&(console.log("a11y_ready"),e.a11y.state.isDebugApplied||(e.a11y.state.isDebugApplied=!0,e("body").on("focus blur click change","*",function(e){console.log("a11y_debug",e.type,e.currentTarget)})))},e.a11y_update=function(){var t=e.a11y.options;a&&(t.OS="mac"),t.isRemoveNotAccessiblesEnabled&&e(".not-accessible[tabindex='0'], .not-accessible [tabindex='0']").attr({tabindex:"-1","aria-hidden":!0}).addClass("aria-hidden"),t.isAriaLabelFixEnabled&&e("body").a11y_aria_label(!0),t.isFocusWrapEnabled&&E(),t.isTabbableTextEnabled||e(l.focusableElementsAccessible).attr({"aria-hidden":"true",tabindex:"-1"}),t.isDebug&&console.log("a11y_update")},e.a11y_on=function(t,a){return e.a11y.options.isDebug&&console.log("$.a11y_on called",t,a),a=a||"body",!1===(t=t===undefined||t)?e(a).attr("aria-hidden",!0):e(a).removeAttr("aria-hidden"),this},e.fn.a11y_on=function(t){return 0===this.length?this:(e.a11y.options.isDebug&&console.log("$.fn.a11y_on called",t,this),(t=t===undefined||t)?(e(l.focuser).focusNoScroll(),this.find(l.hideableElements).filter(n.globalTabIndexElementFilter).attr("aria-hidden","true").attr("tabindex","-1").addClass("aria-hidden")):this.find(l.hideableElements).filter(n.globalTabIndexElementFilter).attr("aria-hidden","false").removeAttr("tabindex").removeClass("aria-hidden"),this.find(l.globalTabIndexElements).filter(n.globalTabIndexElementFilter).a11y_cntrl(t),this)},e.fn.a11y_cntrl=function(t,a){if(0===this.length)return this;var i=e.a11y.options;t=t===undefined||t;for(var s=0;s<this.length;s++){var r=e(this[s]);t&&r.is(l.hideableElements)?(!i.isTabbableTextEnabled&&r.is(l.focusableElementsAccessible)||(r.removeAttr("aria-hidden").removeClass("aria-hidden"),r.parents(n.parentsFilter).removeAttr("aria-hidden").removeClass("aria-hidden")),a&&r.removeAttr("disabled").removeClass("disabled")):t?(!i.isTabbableTextEnabled&&r.is(l.focusableElementsAccessible)||(r.attr({tabindex:"0"}).removeAttr("aria-hidden").removeClass("aria-hidden"),r.parents(n.parentsFilter).removeAttr("aria-hidden").removeClass("aria-hidden")),a&&r.removeAttr("disabled").removeClass("disabled")):(!i.isTabbableTextEnabled&&r.is(l.focusableElementsAccessible)||r.attr({tabindex:"-1","aria-hidden":"true"}).addClass("aria-hidden"),a&&r.attr("disabled","disabled").addClass("disabled"))}return this},e.fn.a11y_cntrl_enabled=function(e){return 0===this.length?this:this.a11y_cntrl(e,!0)};var T=/&.*;/g;e.a11y_normalize=function(t){return e.a11y.options.isTabbableTextEnabled?t=(t=e("<div>"+t+"</div>").text()).replace(T,""):t},e.a11y_text=function(t){return e.a11y.options.isTabbableTextEnabled?b(t):t},e.fn.a11y_text=function(t){if(!e.a11y.options.isTabbableTextEnabled)return t&&this.html(t),this;for(var a=0;a<this.length;a++)t=t||this[a].innerHTML,this[a].innerHTML=b(t);return this},e.fn.a11y_selected=function(t,a){if(0===this.length)return this;if(!e.a11y.options.isSelectedAlertsEnabled)return this;if(t===undefined&&(t=!0),t){var n=e(this[0]);switch(e.a11y.options.OS){case"mac":!0!==a&&e("#a11y-selected").focusNoScroll(),_.delay(function(){n.prepend(e("<span class='a11y-selected aria-label'>selected </span>")),!0!==a&&e(n).focusNoScroll()},250);break;default:!0!==a&&e.a11y_alert("selected "+n.text()),n.attr("aria-label","selected "+n.text()).addClass("a11y-selected")}}else switch(e.a11y.options.OS){case"mac":for(var l=0;l<this.length;l++)e(this[l]).find(".a11y-selected").remove();break;default:for(l=0;l<this.length;l++)e(this[l]).is(".a11y-selected")&&e(this[l]).removeClass("a11y-selected").removeAttr("aria-label"),e(this[l]).find(".a11y-selected").removeClass("a11y-selected").removeAttr("aria-label")}return this},e.a11y_alert=function(t){if(0===this.length)return this;var a=e.a11y.options;if(!a.isAlertsEnabled)return this;var n=e('<div role="alert">'+t+"</div>");switch(e(e.a11y).trigger("reading",t),a.OS){case"mac":e("#a11y-selected").append(n);break;default:n.css("visibility","hidden"),e("#a11y-selected").append(n),n.css("visibility","visible")}return setTimeout(function(){n.remove()},2e4),this},e.fn.a11y_only=function(t,a){if(0===this.length)return this;var i,s,r=e.a11y.state;return a&&r.focusStack.push(r.$activeElement),t!==undefined?(i=e(t).find(l.globalTabIndexElements).filter(n.globalTabIndexElementFilter),s=e(t).find(l.hideableElements).filter(n.globalTabIndexElementFilter)):(i=e(l.globalTabIndexElements).filter(n.globalTabIndexElementFilter),s=e(l.hideableElements).filter(n.globalTabIndexElementFilter)),i.each(function(t,n){var l,i=e(n);n.a11y_uid==undefined&&(n.a11y_uid="UID"+ ++r.elementUIDIndex),l=n.a11y_uid,a&&(r.tabIndexes[l]===undefined&&(r.tabIndexes[l]=[]),r.tabIndexes[l].push(i.attr("tabindex")||0)),i.attr({tabindex:-1,"aria-hidden":!0}).addClass("aria-hidden")}),s.attr("aria-hidden",!0).attr("tabindex","-1").addClass("aria-hidden"),this.find(l.globalTabIndexElements).filter(n.globalTabIndexElementFilter).attr({tabindex:0}).removeAttr("aria-hidden").removeClass("aria-hidden").parents(n.parentsFilter).removeAttr("aria-hidden").removeClass("aria-hidden"),this.find(l.hideableElements).filter(n.globalTabIndexElementFilter).removeAttr("tabindex").removeAttr("aria-hidden").removeClass("aria-hidden").parents(n.parentsFilter).removeAttr("aria-hidden").removeClass("aria-hidden"),e.a11y_update(),this},e.fn.a11y_popup=function(t){if(0===this.length)return this;var a=e.a11y.options;return e.a11y.state.floorStack.push(this),this.a11y_only(t,!0),this.length>0&&e(this[0]).limitedScrollTo(),a.isScrollDisabledOnPopupEnabled&&(e("html").css("overflow-y","hidden"),e.a11y.state.floorStack[e.a11y.state.floorStack.length-2].scrollDisable(),e(l.focusguard,this).css({position:"fixed",bottom:"0px"})),this},e.a11y_popdown=function(){var t=e.a11y.options,a=e.a11y.state;if(!(e.a11y.state.floorStack.length<=1)){var i=e.a11y.state.floorStack.pop();e(l.globalTabIndexElements).filter(n.globalTabIndexElementFilter).each(function(t,n){var i,s=e(n),r=0;if(n.a11y_uid==undefined&&(n.a11y_uid="UID"+ ++a.elementUIDIndex),i=n.a11y_uid,a.tabIndexes[i]!==undefined&&0!==a.tabIndexes[i].length&&(r=parseInt(a.tabIndexes[i].pop())),a.tabIndexes[i]!==undefined&&a.tabIndexes[i].length>0&&delete a.tabIndexes[i],s.attr({tabindex:r}),-1===r)return s.attr("aria-hidden",!0).addClass("aria-hidden");s.removeAttr("aria-hidden").removeClass("aria-hidden"),s.is(l.hideableElements)&&s.removeAttr("tabindex")});var s=a.$activeElement=a.focusStack.pop();return e.a11y_update(),t.isScrollDisabledOnPopupEnabled&&(1==a.floorStack.length&&e("html").css("overflow-y",""),e.a11y.state.floorStack[e.a11y.state.floorStack.length-1].scrollEnable(),e(l.focusguard,i).css({position:"",bottom:""})),r(function(){s==e.a11y.state.$activeElement&&(s?(a.$activeElement=s,a.$activeElement.focusOrNext().limitedScrollTo()):e.a11y_focus())},this,500),this}},e.a11y_focus=function(t){if(t){var a=e(l.focusableElements).filter(n.focusableElementsFilter);return a.length>0&&e(a[0]).focusOrNext(),this}return r(function(){var t=e(l.focusableElements).filter(n.focusableElementsFilter);t.length>0&&e(t[0]).focusOrNext()}),this},e.fn.a11y_focus=function(){return 0===this.length?this:(r(function(){var t=e(this[0]);if(t.is(l.focusableElements))t.focusOrNext();else{var a=t.find(l.focusableElements).filter(n.focusableElementsFilter);if(0===a.length)for(var i=t.parents(),s=0,r=i.length;s<r;s++){if((a=e(i[s]).find(l.focusableElements).filter(n.focusableElementsFilter)).length>0)return e(a[0]).focusOrNext()}else e(a[0]).focusOrNext()}},this),this)},e.fn.a11y_aria_label=function(t){var a=e.a11y.options;if(!a.isAriaLabelFixEnabled)return this;for(var s=[],r=0;r<this.length;r++){if((d=e(this[r])).not(l.ariaLabelElementsFilter).is(l.ariaLabelElements)&&s.push(this[r]),!0===t){var o=d.find(l.ariaLabelElements).filter(n.ariaLabelElementsFilter);s=s.concat(o.toArray())}}if(0===s.length)return this;for(r=0;r<s.length;r++){var d,c=(d=e(s[r])).children();if(0!==c.length){var u=c[0];if(!e(u).is(".aria-label")){var f=d.attr("aria-label");if(f){var b=e(i.arialabel);a.isTabbableTextEnabled||b.attr({tabindex:"-1"}).addClass("a11y-ignore"),b.html(f),d.prepend(b)}d.removeAttr("role").removeAttr("aria-label").removeAttr("tabindex").removeClass("aria-hidden")}}}return this}}(jQuery,window);